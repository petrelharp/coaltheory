<?xml version="1.0" encoding="UTF-8"?>
<?latexml searchpaths="/home/peter/teaching/577A/display"?>
<?latexml class="article"?>
<?latexml package="fullpage"?>
<?latexml package="latexml"?>
<?latexml package="amsmath,amssymb,amsthm"?>
<?latexml package="graphicx"?>
<?latexml package="natbib"?>
<?latexml package="hyperref"?>
<!-- %such that -->
<?latexml RelaxNGSchema="LaTeXML"?>
<document xmlns="http://dlmf.nist.gov/LaTeXML">
  <resource src="LaTeXML.css" type="text/css"/>
  <resource src="ltx-article.css" type="text/css"/>
  <!-- %**** String Line 25 **** 
     %%%%%%% %%%%%%%%-->
  <section xml:id="Sx1">
    <title>General goal</title>
    <para xml:id="Sx1.p1">
      <p>Perhaps we are presented with data: genome sequences plus other information
about a number of individuals that are usually random samples from some population(s),
and we want to learn about their shared history:
estimate levels of relatedness between the samples;
infer their ancestral genome sequence(s);
or identify genomic locations subject to selection.
Or, perhaps we want to compute the levels of genetic diversity
predicted under a certain population model.
In either case, we must understand the relationship between process parameters
(e.g. migration rates, selection coefficients)
and the observed genomic patterns of dissimilarity.</p>
    </para>
    <para xml:id="Sx1.p2">
      <p>This discussion starts out from the unconvential direction
of treating the usual population genetic quantities as summary statistics
of the (unobserved) pedigree–with–recombination, the “ancestral recombination graph”, or ARG.
Often, things like “coalescent time” are defined only in the context of mathematical models,
but can equally well be thought of as descriptive statistics,
whose expected values we can compute under certain models.
This seems to me at least conceptually useful when thinking about such quantities
as estimated from real data, where assumptions such as random mating are rarely met.
<!-- %**** introduction.tex Line 25 **** --></p>
    </para>
    <para xml:id="Sx1.p3">
      <p>Some other discussions that take this point of view to at least some degree are:
<cite><bibref bibrefs="mcvean2002linkage" separator=";" show="Authors Phrase1NumberPhrase2" yyseparator=","><bibrefphrase>(</bibrefphrase><bibrefphrase>)</bibrefphrase></bibref></cite>, OTHERS.
The textbook “Tree Thinking” XXX ALSO XXX ?
Other good references for population genetics are
<cite><bibref bibrefs="hudson1990gene" separator=";" show="Authors Phrase1NumberPhrase2" yyseparator=","><bibrefphrase>(</bibrefphrase><bibrefphrase>)</bibrefphrase></bibref></cite> (a nice article-length review),
and the books
<cite><bibref bibrefs="wakeley2005coalescent" separator=";" show="Authors Phrase1NumberPhrase2" yyseparator=","><bibrefphrase>(</bibrefphrase><bibrefphrase>)</bibrefphrase></bibref></cite> (fairly gentle)
and <cite><bibref bibrefs="ewens2004mathematical" separator=";" show="Authors Phrase1NumberPhrase2" yyseparator=","><bibrefphrase>(</bibrefphrase><bibrefphrase>)</bibrefphrase></bibref></cite> (fairly mathematical).</p>
    </para>
    <!-- %%%%%%% %%%%%%%% -->
  </section>
  <section refnum="1" xml:id="S1">
    <title><tag close=" ">1</tag>Recombination, segregation, and mutation</title>
    <para xml:id="S1.p1">
      <p>First, an outline of how we model diploid reproduction,
i.e. how the autosomal genome of an offspring gets assembled from those of the parents.
There are exceptions (of course), but mostly,
each organism has two copies of each autosomal chromosome,
one from mom and one from dad.
Offspring are the union of two gametes (an egg and a spermatid),
and each gamete is produced by a single diploid cell:</p>
      <itemize xml:id="I1">
        <item xml:id="I1.i1">
          <tag>•</tag>
          <para xml:id="I1.i1.p1">
            <p>duplicating each chromosome (by mitosis)</p>
          </para>
        </item>
        <item xml:id="I1.i2">
          <tag>•</tag>
          <para xml:id="I1.i2.p1">
            <p>recombining the homlogous copies</p>
          </para>
        </item>
        <item xml:id="I1.i3">
          <tag>•</tag>
          <para xml:id="I1.i3.p1">
            <p>segregating these copies among four daughter cells.
<!-- %**** introduction.tex Line 50 **** --></p>
          </para>
        </item>
      </itemize>
      <p>Sometimes all four daughter cells become gametes;
sometimes (e.g. female meiosis in mammals) only one will.</p>
    </para>
    <paragraph xml:id="S1.SS0.SSS0.P1">
      <title>Recombination</title>
      <para xml:id="S1.SS0.SSS0.P1.p1">
        <p>is complicated, varies along the genome, and is affected by genomic factors and motifs.
To make it tractable, we assume that recombination breakpoints occur as a Poisson point process
with constant mean of 2 breakpoints per unit of length,
and that each breakpoint is a crossing over between a randomly chosen maternal and a randomly chosen paternal chromosome.
This produces an average of 1 crossover per chromosome per unit length,
i.e. we are measuring length in genetic map length (Morgans).</p>
      </para>
    </paragraph>
    <paragraph xml:id="S1.SS0.SSS0.P2">
      <title>Mutation</title>
      <!-- %We wouldn’t have got far without ‘‘descent “emph–with modification˝’’ __ and, from thence comes our data __ so we need mutation, also. -->
      <para xml:id="S1.SS0.SSS0.P2.p1">
        <p>In a major concession to mathematical convenience, we’ll simply model mutation as another Poisson point process –
suppose that each gamete differs from its progenitor chromosome at the points of an Poisson point process.
This is the “infinite sites model”, assuming that mutation cannot hit at the same location twice.
Usually we assume the point process of mutations has mean rate <Math mode="inline" xml:id="S1.SS0.SSS0.P2.p1.m1" tex="\mu" text="mu"><XMath><XMTok name="mu" role="UNKNOWN" font="italic">μ</XMTok></XMath></Math> per unit of map length,
but in reality this rate varies along the genome.</p>
      </para>
    </paragraph>
    <paragraph xml:id="S1.SS0.SSS0.P3">
      <title>Segregation</title>
      <para xml:id="S1.SS0.SSS0.P3.p1">
        <p>Once four gametes are produced, it remains to be decided which of the four produce the offspring.
We assume that one is chosen uniformly at random,
independently of the result of recombination.
<!-- %**** introduction.tex Line 75 **** -->(Again, there are exceptions.)</p>
      </para>
      <!-- %%%%%%% %%%%%%%% -->
    </paragraph>
  </section>
  <section refnum="2" xml:id="S2">
    <title><tag close=" ">2</tag>The pedigree, with recombination</title>
    <para xml:id="S2.p1">
      <p>The <emph>pedigree</emph> of a set of individuals is a graph
describing all parent-offspring relationships between these
and some set of their ancestors.
The <emph>population pedigree</emph> describes all such relationships
between all individuals living and possibly dead.
This records mate choice,
but omits the important information of recombination and segregation,
i.e. which parts of each chromosome derive from which of the parents’ two homologous copies.
Adding this information to the pedigree obtains what is known as the <emph>ancestral recombination graph</emph>, or ARG.
There are a number of ways to formalize this notion;
see <cite>(<bibref bibrefs="griffiths1997ancestral,hudson1990gene" separator=";" show="Number" yyseparator=","/>)</cite> for discussions.
One way simply notes that the relatedness structure at any particular locus
is a treelike subset of the pedigree,
and that the collection of these trees – one for each base in the genome, say –
is sufficient to reconstruct the entire history of inheritance, recombination and segregation.
Alternatively, one can annotate each link in the pedigree with a labeling of the genome by <Math mode="inline" xml:id="S2.p1.m1" tex="\{m,p\}" text="set@(m, p)"><XMath><XMApp><XMTok argclose="}" argopen="{" meaning="set" role="FENCED" separators=","/><XMTok role="UNKNOWN" font="italic">m</XMTok><XMTok role="UNKNOWN" font="italic">p</XMTok></XMApp></XMath></Math>,
denoting which segments of the parent’s maternal and paternal chromosomal copies were passed down along that link.
See figure <ref labelref="LABEL:fig:pedigree_ibd"/> for a partial depiction.</p>
    </para>
    <!-- %**** introduction.tex Line 100 **** -->
    <figure frefnum="Figure 1" placement="ht!" refnum="1" xml:id="S2.F1" labels="LABEL:fig:pedigree_ibd">
      <graphics graphic="pedigree-ibd-recombination" options="width=252.945pt" xml:id="S2.F1.g1" class="ltx_centering"/>
      <toccaption><tag close=" ">1</tag>
A small pedigree relating two cousins to their six grandparents,
with the extra information of recombination and segregation on one chromosome
encoded by a coloring: each chromosome is composed
of a patchwork of the grandparental chromosomes.
XXX make additional figure showing marginal gene trees XXX

</toccaption>
      <caption><tag close=": ">Figure 1</tag>
A small pedigree relating two cousins to their six grandparents,
with the extra information of recombination and segregation on one chromosome
encoded by a coloring: each chromosome is composed
of a patchwork of the grandparental chromosomes.
XXX make additional figure showing marginal gene trees XXX

</caption>
    </figure>
    <!-- %%%%%%% %%%%%%%% -->
    <subsection refnum="2.1" xml:id="S2.SS1">
      <title><tag close=" ">2.1</tag>Coalescence times and gene trees</title>
      <para xml:id="S2.SS1.p1">
        <p>Perhaps the simplest thing we can obtain from the full ancestral recombination graph
is the typical degree of relatedness of pairs of individuals.
More concretely, we might ask for the empirical distribution
of pairwise times back to the most recent common ancestor
across all pairs of chromosomes and all loci:
the distribution of <Math mode="inline" xml:id="S2.SS1.p1.m1" tex="\tau_{T}" text="tau _ T"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok name="tau" role="UNKNOWN" font="italic">τ</XMTok><XMTok role="UNKNOWN" font="italic">T</XMTok></XMApp></XMath></Math>, if <Math mode="inline" xml:id="S2.SS1.p1.m2" tex="\tau_{T}" text="tau _ T"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok name="tau" role="UNKNOWN" font="italic">τ</XMTok><XMTok role="UNKNOWN" font="italic">T</XMTok></XMApp></XMath></Math> is the length of a randomly chosen one of these paths.</p>
      </para>
      <para xml:id="S2.SS1.p2">
        <p>A more precise way of formulating this is as follows:
<!-- %**** introduction.tex Line 125 **** -->pick two random chromosomes and a random locus;
follow the lineages of the two chromosomes at that locus up through the pedigree
until their common ancestor;
one-half the number of meioses encountered is <Math mode="inline" xml:id="S2.SS1.p2.m1" tex="\tau_{T}" text="tau _ T"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok name="tau" role="UNKNOWN" font="italic">τ</XMTok><XMTok role="UNKNOWN" font="italic">T</XMTok></XMApp></XMath></Math>.
Since these two lineages will henceforth move together through if followed further back through the pedigree,
<Math mode="inline" xml:id="S2.SS1.p2.m2" tex="\tau_{T}" text="tau _ T"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok name="tau" role="UNKNOWN" font="italic">τ</XMTok><XMTok role="UNKNOWN" font="italic">T</XMTok></XMApp></XMath></Math> is known as the “coalescence time” of the two lineages.</p>
      </para>
      <para xml:id="S2.SS1.p3">
        <p>In this way, the phrase “coalescence time” is shorthand
for “number of generations back to the most recent common ancestor”,
taken as a random quantity across random samples of sets of chromosomes and/or loci.
In this formulation, it is the empirical distribution of lengths of a certain set of paths
to common ancestors through the pedigree.</p>
      </para>
      <para xml:id="S2.SS1.p4">
        <p>The path back through the pedigree along which these two chromosomes have inherited that particular locus
is a very simple tree, with two leaves (at the samples) and a root at their most recent common ancestor;
the height of that tree is the coalescence time.
More generally, the ancestral recombination graph encodes the marginal tree along which,
at each locus, any set of sampled individuals have inherited at that locus.
These are called “gene trees”.
Each gene tree follows a path through the links of the pedigree,
and if due to recombination during one of the meioses,
loci <Math mode="inline" xml:id="S2.SS1.p4.m1" tex="x" text="x"><XMath><XMTok role="UNKNOWN" font="italic">x</XMTok></XMath></Math> and <Math mode="inline" xml:id="S2.SS1.p4.m2" tex="y" text="y"><XMath><XMTok role="UNKNOWN" font="italic">y</XMTok></XMath></Math> are inherited from different parental chromosomes,
the marginal gene trees at <Math mode="inline" xml:id="S2.SS1.p4.m3" tex="x" text="x"><XMath><XMTok role="UNKNOWN" font="italic">x</XMTok></XMath></Math> and <Math mode="inline" xml:id="S2.SS1.p4.m4" tex="y" text="y"><XMath><XMTok role="UNKNOWN" font="italic">y</XMTok></XMath></Math> will differ.</p>
      </para>
      <!-- %**** introduction.tex Line 150 **** 
     %%%%%%% %%%%%%%%%%%%-->
    </subsection>
  </section>
  <section refnum="3" xml:id="S3">
    <title><tag close=" ">3</tag>Conventions and definitions</title>
    <paragraph xml:id="S3.SS1.SSS0.P1">
      <title>Generations</title>
      <para xml:id="S3.SS1.SSS0.P1.p1">
        <p>When two chromosomes share a common ancestor, we like to say that that ancestor lived some number of “generations” in the past.
For most organisms, the notion of a generation is statistical, rather than a fixed quantity.
What we actually care about is the number of meioses separating the two chromosomes –
so, we hereby define the length of a path through the pedigree in generations as one-half the number of meioses.
In fact, in the presence of inbreeding, it is possible for two chromosomes to have inherited different genomic regions
from the same ancestor along different paths through the pedigree, which may have different lengths!</p>
      </para>
    </paragraph>
    <paragraph xml:id="S3.SS1.SSS0.P2">
      <title>Mutation process</title>
      <para xml:id="S3.SS1.SSS0.P2.p1">
        <p>We will mostly work in the <emph>infinite alleles</emph> model of mutation
(which assumes that any mutation produces a unique allele)
and that mutation rates are homogeneous along the genome.
This is clearly not correct, but a very good approximation over the right scales.</p>
      </para>
    </paragraph>
    <paragraph xml:id="S3.SS1.SSS0.P3">
      <title>Discrete or continuous rates</title>
      <para xml:id="S3.SS1.SSS0.P3.p1">
        <p>Here we define <Math mode="inline" xml:id="S3.SS1.SSS0.P3.p1.m1" tex="\mu_{d}" text="mu _ d"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok name="mu" role="UNKNOWN" font="italic">μ</XMTok><XMTok role="UNKNOWN" font="italic">d</XMTok></XMApp></XMath></Math> to be the (“discrete”) mutation rate per generation per base
– the probability that a given base differs from the homologous base in the parent it was inherited from.
We will sometimes find it convenient to use <Math mode="inline" xml:id="S3.SS1.SSS0.P3.p1.m2" tex="\mu=-\log(1-\mu_{d})" text="mu = - logarithm@(1 - mu _ d)"><XMath><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMTok name="mu" role="UNKNOWN" font="italic">μ</XMTok><XMApp><XMTok meaning="minus" role="ADDOP">-</XMTok><XMApp><XMTok argclose=")" argopen="(" meaning="logarithm" role="OPFUNCTION">log</XMTok><XMApp><XMTok meaning="minus" role="ADDOP">-</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok name="mu" role="UNKNOWN" font="italic">μ</XMTok><XMTok role="UNKNOWN" font="italic">d</XMTok></XMApp></XMApp></XMApp></XMApp></XMApp></XMath></Math>,
so that the probability of no mutation across <Math mode="inline" xml:id="S3.SS1.SSS0.P3.p1.m3" tex="2t" text="2 * t"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok meaning="2" role="NUMBER">2</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok></XMApp></XMath></Math> meioses is <Math mode="inline" xml:id="S3.SS1.SSS0.P3.p1.m4" tex="(1-\mu_{d})^{2t}=\exp(-2t\mu)" text="(1 - mu _ d) ^ (2 * t) = exponential@(- 2 * t * mu)"><XMath><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post2"/><XMApp close=")" open="("><XMTok meaning="minus" role="ADDOP">-</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok name="mu" role="UNKNOWN" font="italic">μ</XMTok><XMTok role="UNKNOWN" font="italic">d</XMTok></XMApp></XMApp><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok meaning="2" role="NUMBER">2</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok></XMApp></XMApp><XMApp><XMTok argclose=")" argopen="(" meaning="exponential" role="OPFUNCTION">exp</XMTok><XMApp><XMTok meaning="minus" role="ADDOP">-</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok meaning="2" role="NUMBER">2</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok><XMTok name="mu" role="UNKNOWN" font="italic">μ</XMTok></XMApp></XMApp></XMApp></XMApp></XMath></Math>.</p>
      </para>
    </paragraph>
  </section>
  <bibliography citestyle="authoryear" files="coaltheory" xml:id="bib">
    <title>References</title>
  </bibliography>
</document>
